<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=1.5, user-scalable=yes">
  <title>工作室日常动态</title>
  <link rel="shortcut icon" href="favicon.ico"/>
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" >
  <link rel="stylesheet" href="css/normalize.css"/>
  <link rel="stylesheet" href="css/common.css"/>

  <script src="js/jquery.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="page-header title">
       <h1>不洗碗工作室日常新闻</h1>
    </div>


    <div class="list-group app">
          <a href="#" class="list-group-item ">Cras justo odio</a>
          <a href="#" class="list-group-item">Dapibus ac facilisis in</a>
          <a href="#" class="list-group-item">Morbi leo risus</a>
          <a href="#" class="list-group-item">Porta ac consectetur ac</a>
          <a href="#" class="list-group-item">Vestibulum at eros</a>
          <a href="#" class="list-group-item">Vestibulum at eros</a>

      <nav aria-label="Page navigation" class="footer">
			  <ul class="pagination">
				<li>
				  <a href="#" aria-label="Previous">
					<span aria-hidden="true">&laquo;</span>
				  </a>
				</li>
				<li><a class="pageN" href="#">1</a></li>
				<li><a class="pageN" href="#">2</a></li>
				<li><a class="pageN" href="#">3</a></li>
				<li><a class="pageN" href="#">4</a></li>
				<li><a class="pageN" href="#">5</a></li>
				<li>
				  <a href="#" aria-label="Next">
					<span aria-hidden="true">&raquo;</span>
				  </a>
				</li>
			  </ul>
			</nav>

      <!--<input class="goBack btn btn-default" type="button" value="返回主页"-->
             <!--onclick="window.location.href='index.html'">-->
    </div>

    <script>
       $(function(){
         var strContent = encodeURI($(".list-group-item").html())
         var strNumber = encodeURI($(".list-group-item").size)
         var pageA = $(".pageN")

         $.ajax({
           type:"GET",
           url:"http://hrsoft.net/posts?page=1"+"&size=6",
           dataType: "json",
           data:{ posts: strContent , count: strNumber},
           success: function(json){
             var strTitle = '';
             var strID = '';
             var aTitle = $('.list-group-item');

             for(var i=0;i < json.data.posts.length;i++){
               (function (i) {
                 strTitle = json.data.posts[i].title;
                 strID = json.data.posts[i].id;
                 aTitle.eq(i).attr("id",strID).text(strTitle);   //获取文章列表的核心

                 //在进入某一页之后的查看文章内容
                 aTitle.eq(i).click(function(){
                   var post_ID = aTitle.eq(i).attr('id')
                   $.ajax({
                     type:"GET",
                     url:"http://hrsoft.net/posts/"+post_ID,
                     dataType: "json",
                     data:'{}',
                     success: function(json){
                       if(json.code === 0){
                           window.localStorage.setItem('strContent',json.data.content);
//                           window.location.href= 'news.html'
                         console.log(json.data.content);
                       }else if(json.code === 3001){
                         alert("文章不存在！")
                       }
                     }
                   })
                 })

               })(i)
             }
           }
         })

         for(var i=0;i<pageA.length;i++){
           (function (i) {
//             点击每个分页请求的数据不同
             pageA.eq(i).click(function(){
              window.localStorage.setItem("page", pageA.eq(i).html())

               var page = window.localStorage.getItem('page')

               //手动点击选择页码
               $.ajax({
                 type:"GET",
                 url:"http://hrsoft.net/posts?page="+page+"&size=6",
                 dataType: "json",
                 data:{ posts: strContent , count: strNumber},
                 success: function(json){
                   var strTitle = '';
                   var strID = '';
                   var aTitle = $('.list-group-item');

//             function retHTML(){
//               var str = '<a href="#" class="list-group-item">Dapibus ac facilisis in</a>';
//               return str;
//             }

                   for(var i=0;i < json.data.posts.length;i++){
                     (function (i) {
//                       console.log(json.data.posts[i]);
                       strTitle = json.data.posts[i].title;
                       strID = json.data.posts[i].id;

//                 $('.app').append(retHTML);

                       //获取文章列表的核心
                       aTitle.eq(i).attr("id",strID).text(strTitle);

                       aTitle.eq(i).click(function(){
                         var post_ID = aTitle.eq(i).attr('id')
                         $.ajax({
                           type:"GET",
                           url:"http://hrsoft.net/posts/"+post_ID,
                           dataType: "json",
                           data:'{}',
                           success: function(json){
                               if(json.code === 0){
                                 window.localStorage.setItem('strContent',json.data.content);
                                 window.location.href= 'news.html'
                                 console.log(json.data.content);
                               }else if(json.code === 3001){
                                 alert("文章不存在！")
                               }
                           }
                         })
                       })
                     })(i)
                   }
                 }
               })
             })
           })(i)
         }
       });
    </script>
</body>
</html>